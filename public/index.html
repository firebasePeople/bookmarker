<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Booktracker</title>

</head>

<body>
    <h2>My booktracker</h2>
    <div id="readingDiv">
        <h4>Reading</h4>
        <input type="text" name="readingInput" id="readingInput" placeholder="add new book" />
        <button id="readingBtn">Add</button>

        <ul id="readingUl">
            <li>reading</li>
        </ul>
    </div>
    <div id="toreadDiv">
        <h4>To read</h4>
        <input type="text" name="toreadInput" id="toreadInput" placeholder="add new book" />
        <button id="toreadBtn">Add</button>
        <ul id="toreadUl">
            <li>To read</li>
        </ul>
    </div>
    <div id="readDiv">
        <h4>Done reading</h4>
        <input type="text" name="readInput" id="readInput" placeholder="add new book" />
        <button id="readBtn">Add</button>
        <ul id="readUl">
            <li>Done Reading</li>
        </ul>
    </div>


    <!-- <script src="https://www.gstatic.com/firebasejs/5.2.0/firebase.js"></script> -->
    <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-app.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-auth.js"></script> -->
    <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-database.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-messaging.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-functions.js"></script> -->
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyC8fCrFKojwN3idl3rxDbdl87PzFYP7kNk",
            authDomain: "booktracker-9643e.firebaseapp.com",
            databaseURL: "https://booktracker-9643e.firebaseio.com",
            projectId: "booktracker-9643e",
            storageBucket: "booktracker-9643e.appspot.com",
            messagingSenderId: "801458307525"
        };
        firebase.initializeApp(config);
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function(e) {
            // e.preventDefault();

            var dbRef = firebase.database();


            function getDbData(collectionName) {
                var collRef = dbRef.ref().child(collectionName);

                collRef.on('value', function(snapshot) {
                    console.log(snapshot.val());
                });
            };


            var readingBtn = document.querySelector('#readingBtn');
            var toreadBtn = document.querySelector('#toreadBtn');
            var readBtn = document.querySelector('#readBtn');

            readingBtn.addEventListener('click', function() {
                var readingField = document.querySelector('#readingInput').value;
                dbRef.ref().child('reading').push({
                    bookname: readingField
                }).then(function() {
                    // console.log('success!book added successfully');
                    insertIntoList(readingField, "readingUl");
                    inputClearFunction("readingInput");
                    getDbData('reading');

                }).catch(function(error) {
                    window.alert('error adding book to the list');
                });
                console.log(readingField);
            });

            toreadBtn.addEventListener('click', function() {
                var toreadField = document.querySelector('#toreadInput').value;
                dbRef.ref().child('toread').push({
                    bookname: toreadField
                }).then(function() {
                    // console.log('success!book added successfully');
                    insertIntoList(toreadField, "toreadUl");
                    inputClearFunction("toreadInput");
                    getDbData('toread');


                }).catch(function(error) {
                    window.alert('error adding book to the list');

                });
                console.log(toreadField);
            });

            readBtn.addEventListener('click', function() {
                var readField = document.querySelector('#readInput').value;
                dbRef.ref().child('read').push({
                    bookname: readField
                }).then(function() {
                    // console.log('success!book added successfully');
                    insertIntoList(readField, "readUl");
                    inputClearFunction("readInput");
                    getDbData('read');


                }).catch(function(error) {
                    window.alert('error adding book to the list');
                });
                console.log(readField);
            });

            function insertIntoList(bookName, UlIdParam) {
                var liElement = document.createElement('li');
                var ulId = document.querySelector('#' + UlIdParam);
                liElement.innerText = bookName;
                liElement.id = bookName;
                ulId.insertBefore(liElement, ulId.childNodes[0]);
            }

            function inputClearFunction(inputFieldId) {
                var tempreadIP = document.getElementById(inputFieldId);
                tempreadIP.value = '';
            }

        });
    </script>
</body>

</html>